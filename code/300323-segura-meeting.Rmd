---
title: "300323-segura-meeting"
output: html_document
date: "2023-03-29"
---

### load libraries
```{r, load}
library(tidyverse)
library(dplyr)
```

### Write function to collect data for epidermis and dermis into two dataframes
```{r, txt-to-df}
# write code in R to turn multiple txt files into one dataframe where each column corresponds to one txt file

# set working directory to folder containing txt files
collect_data <- function(path_to_folder_with_txts_as_string, file_name, type="txt"){
  # set your working directory to the folder where your txt files are located
setwd(path_to_folder_with_txts_as_string)

# create a list of all the txt files in the folder
txt_files <- list.files(pattern = "\\.txt$")

# create an empty dataframe to hold the data
combined_df <- data.frame()

# loop through each txt file and append it to the dataframe
for (file in txt_files) {
  # read in the txt file as a dataframe
  temp_df <- read.table(file, header = TRUE)
  # append NA values to make sure all columns have the same length
  if (nrow(temp_df) < nrow(combined_df)) {
    temp_df[(nrow(temp_df)+1):nrow(combined_df),] <- NA
  } else if (nrow(temp_df) > nrow(combined_df)) {
    combined_df[(nrow(combined_df)+1):nrow(temp_df),] <- NA
  }
  # combine the temp dataframe with the combined dataframe
  combined_df <- cbind(combined_df, temp_df)
}

# rename the columns to match the original file names
colnames(combined_df) <- txt_files

# view the final dataframe
combined_df

  
  return(combined_df)
}

# In this code, setwd() sets the working directory to the folder containing the txt files. The list.files() function creates a vector of all txt file names in the directory. The data.frame() function creates an empty dataframe to store the combined data. The for loop reads in data from each txt file and appends it to the combined_data dataframe using the cbind() function. Finally, the colnames() function renames the columns of the dataframe with the names of the txt files.

#This code assumes that all of the txt files have the same structure and that they all have headers. 



```

### Collect micron epidermis and dermis pixel (unaltered) data into two dataframes
```{r, use-collect-data-function-epidermis, warning=FALSE}
# collect all epidermis data
  # set path
path_to_folder <- "../data/Epidermal-thickness-prism"
  #check path
list.files(path_to_folder)

all_epidermis<-collect_data(path_to_folder)
```

```{r, use-collect-data-function-dermis, warning=FALSE}
# collect all dermis data
path_to_folder2 <- "../data/Dermal-thickness-prism"
  #check path
list.files(path_to_folder2)

all_dermis<-collect_data(path_to_folder2)
```

### Save the epidermis and dermis pixel dataframes as csv files
```{r, save-dermis-and-epidermis-dfs}
## ONLY RUN IF DATAFRAMS NOT ALREADY SAVED!

write.csv(all_epidermis, file=paste0("../data/","all_epidermis_lengths_in_pixels.csv"))
write.csv(all_dermis, file=paste0("../data/","all_dermis_lengths_in_pixels.csv"))
```

### rename epidermis and dermis df for readability
```{r, load-pixel-epiderm-derm}
all_dermis_lengths_in_pixels <- all_dermis
all_epidermis_lengths_in_pixels <- all_epidermis
```

### visualize spread of each animal's pixel lengths...
#### spread of each animal's pixel lengths for epidermis
```{r, spread-epi-pixel}
df_set1<-all_epidermis_lengths_in_pixels[,1:6]
df_set2<-all_epidermis_lengths_in_pixels[,7:12]
df_set3<-all_epidermis_lengths_in_pixels[,13:18]
df_set4<-all_epidermis_lengths_in_pixels[,19:24]
df_set5<-all_epidermis_lengths_in_pixels[,25:30]

# convert data to long format using tidyr::pivot_longer()
long1 <- tidyr::pivot_longer(df_set1, everything())
long2 <- tidyr::pivot_longer(df_set2, everything())
long3 <- tidyr::pivot_longer(df_set3, everything())
long4 <- tidyr::pivot_longer(df_set4, everything())
long5 <- tidyr::pivot_longer(df_set5, everything())

# plot using ggplot and facet_wrap()
p1<-ggplot(long1[], aes(x = value)) +
  geom_histogram(color="black", fill="white") +
  facet_wrap(~ name, scales = "free") +
  labs(x = "Pixel Value", y = "Frequency")
p1
ggsave("animal-pixel-lenght-spread1.jpg", plot = p1, dpi = 300, width = 6, height = 4, units = "in")

p2<-ggplot(long2[], aes(x = value)) +
  geom_histogram(color="black", fill="white") +
  facet_wrap(~ name, scales = "free") +
  labs(x = "Pixel Value", y = "Frequency")
p2
ggsave("animal-pixel-lenght-spread2.jpg", plot = p2, dpi = 300, width = 6, height = 4, units = "in")

p3<-ggplot(long3[], aes(x = value)) +
  geom_histogram(color="black", fill="white") +
  facet_wrap(~ name, scales = "free") +
  labs(x = "Pixel Value", y = "Frequency")
ggsave("animal-pixel-lenght-spread3.jpg", plot = p3, dpi = 300, width = 6, height = 4, units = "in")

p4<-ggplot(long4[], aes(x = value)) +
  geom_histogram(color="black", fill="white") +
  facet_wrap(~ name, scales = "free") +
  labs(x = "Pixel Value", y = "Frequency")
ggsave("animal-pixel-lenght-spread4.jpg", plot = p4, dpi = 300, width = 6, height = 4, units = "in")

p5<-ggplot(long5[], aes(x = value)) +
  geom_histogram(color="black", fill="white") +
  facet_wrap(~ name, scales = "free") +
  labs(x = "Pixel Value", y = "Frequency")
ggsave("animal-pixel-lenght-spread5.jpg", plot = p5, dpi = 300, width = 6, height = 4, units = "in")
```
#### spread of each animal's pixel lengths for dermis
```{r, spread-epi-pixel}
df_set1<-all_dermis_lengths_in_pixels[,1:6]
df_set2<-all_dermis_lengths_in_pixels[,7:12]
df_set3<-all_dermis_lengths_in_pixels[,13:18]
df_set4<-all_dermis_lengths_in_pixels[,19:24]
df_set5<-all_dermis_lengths_in_pixels[,25:30]

# convert data to long format using tidyr::pivot_longer()
long1 <- tidyr::pivot_longer(df_set1, everything())
long2 <- tidyr::pivot_longer(df_set2, everything())
long3 <- tidyr::pivot_longer(df_set3, everything())
long4 <- tidyr::pivot_longer(df_set4, everything())
long5 <- tidyr::pivot_longer(df_set5, everything())

# plot using ggplot and facet_wrap()
p1<-ggplot(long1[], aes(x = value)) +
  geom_histogram(color="black", fill="white") +
  facet_wrap(~ name, scales = "free") +
  labs(x = "Pixel Value", y = "Frequency")
p1
ggsave("animal-derm-pixel-length-spread1.jpg", plot = p1, dpi = 300, width = 6, height = 4, units = "in")

p2<-ggplot(long2[], aes(x = value)) +
  geom_histogram(color="black", fill="white") +
  facet_wrap(~ name, scales = "free") +
  labs(x = "Pixel Value", y = "Frequency")
p2
ggsave("animal-derm-pixel-length-spread2.jpg", plot = p2, dpi = 300, width = 6, height = 4, units = "in")

p3<-ggplot(long3[], aes(x = value)) +
  geom_histogram(color="black", fill="white") +
  facet_wrap(~ name, scales = "free") +
  labs(x = "Pixel Value", y = "Frequency")
ggsave("animal-derm-pixel-length-spread3.jpg", plot = p3, dpi = 300, width = 6, height = 4, units = "in")

p4<-ggplot(long4[], aes(x = value)) +
  geom_histogram(color="black", fill="white") +
  facet_wrap(~ name, scales = "free") +
  labs(x = "Pixel Value", y = "Frequency")
ggsave("animal-derm-pixel-length-spread4.jpg", plot = p4, dpi = 300, width = 6, height = 4, units = "in")

p5<-ggplot(long5[], aes(x = value)) +
  geom_histogram(color="black", fill="white") +
  facet_wrap(~ name, scales = "free") +
  labs(x = "Pixel Value", y = "Frequency")
ggsave("animal-derm-pixel-length-spread5.jpg", plot = p5, dpi = 300, width = 6, height = 4, units = "in")
```

